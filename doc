import pandas as pd

# Example dataframe
# df = pd.DataFrame({'dispatch_month': [...], 'warranty_month': [...], 'warranty_cost': [...]})

# Convert to datetime
df['dispatch_month'] = pd.to_datetime(df['dispatch_month'])
df['warranty_month'] = pd.to_datetime(df['warranty_month'])

matrix = df.pivot_table(
    index='dispatch_month',        # Rows: dispatch month
    columns='vehicle_age',         # Columns: vehicle age
    values='warranty_cost',        # Value to aggregate
    aggfunc='sum',                 # Or 'mean' if preferred
    fill_value=0
)


# Create Excel writer object
with pd.ExcelWriter('warranty_cost_matrix.xlsx', engine='xlsxwriter') as writer:
    matrix1.to_excel(writer, sheet_name='Matrix1')
    matrix2.to_excel(writer, sheet_name='Matrix2')
